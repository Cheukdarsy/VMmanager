{% extends 'base.html' %}
{% load mytags %}


{% block content %}
    {% include 'nav_cat_bar.html' %}
<div class="wrapper wrapper-content animated fadeInRight">
    <div class="row">
        <div class="col-sm-10">
            <div class="ibox float-e-margins">
                <div class="ibox-title">
                    <h5>VM设置</h5>
                    <div class="ibox-tools">
                        <a class="collapse-link"> <i class="fa fa-chevron-up"></i>
                        </a>
                        <a class="dropdown-toggle" data-toggle="dropdown" href="#"> <i class="fa fa-wrench"></i>
                        </a>
                        <a class="close-link">
                            <i class="fa fa-times"></i>
                        </a>
                    </div>
                </div>

                <div class="ibox-content">
                    <div class="panel blank-panel">
                        <div class="panel-heading">
                            <div class="panel-options">
                                <ul class="nav nav-tabs">
                                    <!-- <li id="tab1" class="active">
                                    <a data-toggle="tab" href="#tab-default" aria-expanded="true">默认设置</a>
                                </li>
                                -->
                                <li id="tab1" class="active">
                                    <a data-toggle="tab" href="#tab-vmware" aria-expanded="true">VMware环境配置</a>
                                </li>
                                <li id="tab２">
                                    <a data-toggle="tab" href="#tab-parameter" aria-expanded="true">申请参数配置</a>
                                </li>
                            </ul>
                        </div>
                    </div>

                    <div class="panel-body">
                        <div class="tab-content">
                            <div id="tab-vmware" class="tab-pane active col-sm-10">

                                <div class="panel panel-default">
                                    <div class="panel-heading">
                                        vCenter配置
                                        <button id='vcenter-setting' class="btn btn-xs btn-primary" data-toggle="modal" data-target="#add-vm-modal" style="float:right">
                                            添加VM
                                            <i class="fa fa-plus"></i>
                                        </button>
                                    </div>
                                    <div class="panel-body">
                                        <table class="table table-striped table-hover table-cendensed" id="vcenter-table" >
                                            <tr>
                                                <th class="text-center">IP</th>
                                                <th class="text-center">用户</th>
                                                <th class="text-center">密码</th>
                                                <th class="text-center">端口</th>
                                                <th class="text-center">操作</th>
                                            </tr>
                                            <tr>
                                                <td class="text-center">1</td>
                                                <td class="text-center">118.240.13.25</td>
                                                <td class="text-center">23</td>
                                                <td class="text-center">23</td>
                                                <td class="text-center">
                                                    <button class="btn btn-xs btn-success"  data-toggle="modal" data-target="#modify-vm-modal">修改</button>
                                                    {% include 'jvmanager/modify_vcenter_modal.html' %}  
                                                    <button class="btn btn-xs btn-primary">同步</button>
                                                    <button class="btn btn-xs btn-danger">删除</button>
                                                </td>
                                                <td class="text-center"></td>
                                            </tr>
                                        </table>
                                        {% include 'jvmanager/add_vcenter_modal.html' %}  
                                    </div>
                                </div>
                                <div class="panel panel-default">
                                    <div class="panel-heading">
                                        IP池配置
                                        <button id='ip-setting' class="btn btn-xs btn-info" data-toggle="modal" data-target="#add-IP-modal" style="float:right">
                                            手工添加IP网段
                                            <i class="fa fa-plus"></i>
                                        </button>
                                    </div>
                                    <div class="panel-body">
                                      <table class="table table-striped table-hover table-cendensed" id="ip-table" >
                                            <tr>
                                                <th class="text-center">VLAN ID</th>
                                                <th class="text-center">网段</th>
                                                <th class="text-center">来源</th>
                                                <th class="text-center">状态</th>
                                                <th class="text-center">操作</th>
                                            </tr>
                                            <tr>
                                                <td class="text-center">1</td>
                                                <td class="text-center">118.240.13.25</td>
                                                <td class="text-center">23</td>
                                                <td class="text-center">23</td>
                                                <td class="text-center">
                                                    <button class="btn btn-xs btn-success">IP池初始化</button>
                                                    
                                                </td>
                                                <td class="text-center"></td>
                                            </tr>
                                        </table>  
                                    </div>

                                    </div>

                            </div>
                            <div id="tab-parameter" class="tab-pane col-sm-10">
                                <div class="panel panel-default">

                                    <div class="panel-heading">
                                        环境类型
                                        <button id='add-env' class="btn btn-xs btn-primary" style="float:right">
                                            添加环境类型
                                            <i class="fa fa-plus"></i>
                                        </button>
                                    </div>
                                    <div class="panel-body">
                                        <table class="table table-striped table-hover table-bordered" id="env-table" >
                                            <tr>
                                                <th class="text-center">序号</th>
                                                <th class="text-center" style='width:300px'>环境类型</th>
                                                <th class="text-center">操作</th>
                                                
                                            </tr>
                                            <tr>
                                                <td class="text-center">1</td>
                                                <td class="text-center">测试环境</td>
                                                <td class="text-center">
                                                    <button class="btn btn-xs btn-success">修改</button>
                                                    <button class="btn btn-xs btn-danger">删除</button>
                                                </td>
                                                <td class="text-center"></td>
                                            </tr>
                                        </table>
                                    </div>
                                </div>
                                <div class="panel panel-default">

                                    <div class="panel-heading">
                                        操作系统类型
                                        <button id='add-os' class="btn btn-xs btn-primary" style="float:right">
                                            添加系统
                                            <i class="fa fa-plus"></i>
                                        </button>
                                    </div>
                                    <div class="panel-body">
                                        <table class="table table-striped table-hover table-cendensed" id="parameter-table" >
                                            <tr>
                                                <th class="text-center">序号</th>
                                                <th class="text-center">操作系统类型</th>
                                                <th class="text-center">系统版本</th>
                                                <th class="text-center">备注</th>
                                                <th class="text-center">操作</th>
                                                
                                            </tr>
                                            <tr>
                                                <td class="text-center">1</td>
                                                <td class="text-center">WINDOWS 2008</td>
                                                <td class="text-center">R2</td>
                                                <td class="text-center">仅用于测试环境</td>
                                                <td class="text-center">
                                                    <button class="btn btn-xs btn-success">修改</button>
                                                    <button class="btn btn-xs btn-danger">删除</button>
                                                </td>
                                                <td class="text-center"></td>
                                            </tr>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
</div>
{% endblock %}
{% block self_footer_js %}
<style type="text/css">.selectpicker {  width: 120px;height: 30px;}</style>
<script>
    $('#vc-setting-form').validator({
        timely: 2,
        theme: "yellow_right_effect",
        rules: {
            check_name: [/^\w{2,20}$/, '大小写字母数字和下划线,2-20位'],
            check_port: [/^\d{1,5}$/, '端口号不正确'],
            check_ip:[/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/,'IP格式不正确']
        },

        fields: {
            "vcip": {
                rule: "required;check_ip",
                tip: "输入VC的IP",
                ok: "",
                msg: {required: "IP必填"}
            },
            "vcport":{
                rule:"required;check_port",
                tip:"输入端口，默认23",
                ok:"",
                msg:{required:"端口必填"}
            },
            "vcname":{
                rule:"required;check_name",
                tip:"输入用户名",
                ok:"",
                msg:{required:"用户名不能为空"}
            },
            "vcpw":{
                rule:"required",
                tip:"输入密码",
                ok:"",
                msg:{required:"密码必填"}
            },
            "vcpw-conf":{
                rule:"required;match[vcpw]",
                tip:"",
                ok:"",
                msg:{required:"密码确认",match:"密码不一致"}
            }
        },
        valid: function(form) {
                alert("提交成功");
                form.submit()
                //ajax;
            }
    })
    var vccount = 1,ipcount = 1;
    
    $(document).on('click', '#add-env', function(event) {
        ipcount++;
        html = "<tr><td class='text-center'>"+ipcount+"</td><td class='text-center' id='env-td-"+ipcount+"'><input type='text' placeholder='输入环境名称' id='inner-input"+ipcount+"'></td><td class='text-center' id='env-btn-td-"+ipcount+"'><button class='btn btn-xs btn-success' id='add-env-"+ipcount+"'>确认添加</button></td></tr>";
        $("#env-table").append(html);
        $("#inner-input"+ipcount).focus();
        $("#add-env-"+ipcount).click(function(event) {
             if($("#inner-input"+ipcount).val()){
                //ajax提交
                $("#env-td-"+ipcount).html($("#inner-input"+ipcount).val())
                $("#env-btn-td-"+ipcount).html("<button class='btn btn-xs btn-success' style='margin-right:5px'>修改</button><button class='btn btn-xs btn-danger'>删除</button>")
             }
        });
    });
    $(document).on('click', '#templat-select', function(event) {
        alert($("#template-select").val())
    });
    $("#templateselect option").each(function(index, el) {
        var vc = $(this).val()
        $(this).click(function(event) {
            alert("ajax输出对应"+vc+"的模板");
        });
    });
    /*$(document).on('click',".vcenter-setting",function(event) {
        html = "<tr><td class='text-center'>2</td><td class='text-center'><select name='vcenter' id='v2' class='selectpicker'><option id='v2o'>rt5445</option></select></td><td class='text-center'><button class='btn btn-xs btn-success' id='vc-conf-add'>确认添加</button></td><td class='text-center'></td></tr>"
        $("#vcenter-table").append(html);
        $(this).attr('disabled', 'True');
    });
    $(document).on('click',"#vc-conf-add",function(event) {
        $(this).parent().siblings('td').eq(1).empty().append('<p>hello</p>');
        $(this).parent().siblings('td').eq(2).empty().append('<button class="btn btn-xs btn-info vcenter-setting">添加<i class="fa fa-plus"></i></button>')
    });
    $("#ip-setting").click(function(event) {
        html = "<tr><td class='text-center'>2</td><td class='text-center'><select name='vcenter' id='v2' class='selectpicker'><option id='v2o'>rt5445</option></select></td><td class='text-center'><button class='btn btn-xs btn-success'>确认激活</button></td><td class='text-center'></td></tr>"
        $("#ip-table").append(html);
        $(this).attr('disabled', 'True');
    });*/
</script>
{% endblock %}